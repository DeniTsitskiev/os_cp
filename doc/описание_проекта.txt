Проект: "Быки и коровы" (угадывание слов)
=========================================

Что это такое
-------------
Это клиент-серверная игра "Быки и коровы", где нужно угадать 5-буквенное слово. 
Связь между клиентом и сервером организована через ZeroMQ (ROUTER/DEALER). 
Игру создаёт первый игрок, остальные присоединяются по имени игры. 
Игра продолжается даже если один из игроков вышел.

Кратко о протоколе
------------------
- Транспорт: ZeroMQ, адрес по умолчанию tcp://localhost:5555 (server) / tcp://*:5555 (server bind).
- Сокет сервера: ROUTER. Сокет клиента: DEALER.
- Сообщения — просто сериализованные C-структуры (Msg). Сервер и клиент должны быть одинаково собраны.

Типы сообщений (Msg.cmd)
------------------------
Клиент → Сервер:
- MSG_NEW_GAME      : создать игру (game_id, user_name, player_cnt)
- MSG_JOIN_BY_ID    : присоединиться к игре по имени (game_id, user_name)
- MSG_MAKE_TRY      : попытка угадать слово (game_id, user_name, word)
- MSG_QUIT_GAME     : игрок выходит из игры (game_id, user_name)
- MSG_GET_GAMES     : запрос количества активных игр

Сервер → Клиент:
- MSG_GAME_OK       : игра создана/действие успешно
- MSG_JOINED_OK     : игрок успешно присоединился
- MSG_TRY_RESULT    : результат попытки (быки/коровы)
- MSG_WIN           : игра выиграна (быков == длине слова)
- MSG_GAMES_LIST    : ответ на список игр (total_games)
- MSG_FAIL          : ошибка (msg)

Структура Msg (упрощённо)
-------------------------
- cmd            : тип сообщения (MsgType)
- game_id        : имя игры (строка)
- user_name      : имя игрока (строка)
- player_cnt     : число игроков при создании
- word           : слово попытки (для MSG_MAKE_TRY)
- res.bulls/cows : результат попытки
- res.try_num    : номер попытки игрока
- res.who        : имя игрока, сделавшего попытку
- msg            : текст ошибки/сообщения
- total_games    : кол-во активных игр (для списка)

Логика игры на сервере
----------------------
- При создании игры генерируется секретное слово из словаря (func.c: words_pool).
- В игре хранится список игроков (до 10). Каждый знает число своих попыток.
- Игра активна, пока не угадано слово или не вышли все активные игроки.
- Выход игрока (MSG_QUIT_GAME) просто помечает его как неактивного; если активных не осталось — игра завершается.
- Обработка запросов идёт в отдельных потоках (до 50), каждый запрос → новый поток.

Логика клиента
--------------
- Меню (русское):
  1) Создать игру
  2) Присоединиться к игре
  3) Список игр
  4) Выход
- При создании указываете имя игры и число игроков.
- При присоединении вводите имя игры.
- Во время игры вводите 5-буквенные слова из словаря (латиница, строчные).
- Специальный ввод `quit` — выйти из текущей игры (отправляется MSG_QUIT_GAME).
- После каждого запроса клиент ждёт ответ сервера и печатает быков/коров или ошибку.

Проверки и правила слова
------------------------
- Слово фиксированной длины 5 символов.
- Допустимы только строчные латинские буквы a-z.
- Слово должно быть в словаре (func.c: words_pool). Примеры: house, heart, river, magic, stone.

Сборка
------
Из директории src (WSL/Linux):
- `make`           — собрать сервер и клиент
- `make server`    — только сервер
- `make client`    — только клиент
- `make clean`     — удалить бинарники

Запуск вручную
--------------
Терминал 1 (сервер):
- `./server`

Терминал 2 (клиент):
- `./client`
- Введите имя игрока.
- В меню: 1 — создать игру (название и число игроков), 2 — присоединиться по имени, 3 — вывести число активных игр.
- В режиме игры вводите слова, пока не получите 5 быков. `quit` — выход.

Структура исходников (src)
--------------------------
- func.h / func.c — определения сообщений, словарь, функции подсчёта быков/коров.
- server.c           — многопоточный сервер ZeroMQ (ROUTER), логика игр и игроков.
- client.c           — консольный клиент ZeroMQ (DEALER), меню и игровой цикл.
- Makefile           — сборка (gcc, -std=c11, -Wall -Wextra, -pthread, -lzmq).

Основные функции
----------------
Общее (func.c):
- msg_create / msg_send / msg_recv — инициализация/отправка/приём Msg.
- gen_word — случайный выбор слова из словаря.
- check_word — считает быков и коров для 5-буквенных слов.
- word_ok — проверка валидности и наличия слова в словаре.

Сервер (server.c):
- do_new_play      — создать игру.
- do_join          — присоединить игрока.
- do_try           — обработать попытку (быки/коровы, победа).
- do_quit          — отметить выход игрока, завершить игру если активных не осталось.
- do_list          — вернуть число активных игр.
- work_msg         — диспетчер команд.
- client_thread    — обработка одного запроса в отдельном потоке.

Клиент (client.c):
- show_rules       — краткие правила.
- get_word         — чтение слова/команды quit.
- make_game        — запрос создания игры.
- join_game        — запрос присоединения.
- list_games       — запрос списка игр.
- game_play        — игровой цикл (попытки, выход по quit).
- menu / main      — консольное меню и точка входа.

Словарь
-------
Встроенный список ~40 слов (func.c: words_pool). Все слова в нижнем регистре, латиница. 
Вы можете расширить словарь, добавив новые строки в words_pool и пересобрав проект.

Как считать быков/коров (кратко)
--------------------------------
- Быки: позиции, где буквы совпали.
- Коровы: совпавшие буквы на других позициях. Считается через частоты букв, исключая быков.

Особенности и ограничения
-------------------------
- Сериализация "сырая": структуры Msg шлются как бинарные блоки. Клиент и сервер должны быть собраны одной версией.
- Нет аутентификации и шифрования — играть только в доверенной сети.
- Лимиты: до 50 игр, до 10 игроков в игре, до 50 потоков обработки.
- Игра завершается при победе или если все активные игроки вышли.

Быстрый старт (WSL)
-------------------
1) Сборка:
   `wsl -e bash -c "cd /mnt/c/Users/chmona/Desktop/OS/Smart_os/src && make"`
2) Сервер:
   `wsl -e bash -c "cd /mnt/c/Users/chmona/Desktop/OS/Smart_os/src && ./server"`
3) Клиент:
   `wsl -e bash -c "cd /mnt/c/Users/chmona/Desktop/OS/Smart_os/src && ./client"`

Мини-FAQ
--------
Q: Почему "quit"? 
A: Это простой маркер выхода в игровом цикле клиента.

Q: Что если ввести слово не из словаря? 
A: Клиент напомнит, что слово неверное, и попросит повторить ввод.

Q: Можно ли менять длину слова? 
A: Сейчас длина зашита (WORD_LENGTH = 5). Понадобится менять константу, проверки и словарь.

Q: Что будет, если игрок вышел? 
A: Он помечается неактивным. Если активных не осталось, игра завершается.

Источники и лицензии
--------------------
- ZeroMQ: требуется установленная библиотека libzmq (например, sudo apt install libzmq3-dev).
- Код написан как учебный пример, без отдельной лицензии; используйте свободно в рамках учебных целей.
